---
slug: dev-config
title: Configuration Related to Development Environment
tags:
  - webpack4.0
categories:
  - Front-end
  - Summary of Learning webpack4.0
references:
  - name: >-
      From Basics to Practice, Hand in Hand to Master the New Version of
      Webpack4.0
    url: 'https://coding.imooc.com/class/chapter/316.html#Anchor'
  - name: webpack Official Website
    url: 'https://webpack.js.org/'
description: >-
  webpack introductory tutorial, introducing how to optimize our development
  efficiency by using webpack's devServer to configure hot updates and HMR to
  configure partial hot updates.
keywords:
  - webpack
  - webpack introductory tutorial
  - webpack devServer
  - HMR
date: 2020-05-18T10:24:19.000Z
updated: 2020-05-20T15:19:00.000Z
sidebar_position: 4
summary: >-
  Webpack's DevServer can start a local service and implement hot updates of the
  code, eliminating the need to restart the service.


  HMR (Hot Module Replacement) can implement partial hot updates. When only part
  of the files are changed, only this part of the content is updated.


  Configure the devServer and HMR options in webpack.config.js to use these
  functions.


  devServer can automatically open the browser and set the port number. HMR can
  accept hot updates of the modules and re-render the affected components after
  the update.


  When configuring HMR, additional code needs to be added to the modules that
  need hot updates to process the updates.
ai_translation: true
---

We can use some configurations to optimize our development efficiency, webpack's devServer hot updates and HMR partial hot updates.

<!--truncate-->

## DevServer

DevServer can start a local service and implement hot updates of the code. It can save us the trouble of restarting the service every time we update the code.

```
npm i webpack-dev-server -D
```

Configuration file

package.json

```json
"scripts": {
  "build": "webpack",
  "start": "webpack-dev-server"
},
```

webpack.config.js

```js
devServer: {
  contentBase: './dist',
  open: true, // Automatically open the browser
  port: 3001, // Server port number
},
```

After that, we only need to use `npm run start` to run the service, and then the service will be automatically updated whenever the code is changed, which greatly improves the development efficiency. Isn't it amazing? üòù

:::info
devServer [More configuration content](https://webpack.js.org/configuration/dev-server/#devserver)
:::

## HMR Implements Partial Hot Updates

HMR (Hot Module Replacement)

When we change some files, we find that webpack-dev-server helps us re-render all the content. If I only change a small part of it, I only want to update this part of the content. I can use HMR to achieve this.

It's better to see an example than to say more

<Tabs>
<TabItem value="index.js" label="index.js">

```js
import './index.css';

var root = document.getElementById('root');

root.innerHTML = '<button id="btn">add new block</button>';

document.getElementById('btn').onclick = function () {
  var newBlock = document.createElement('p');
  newBlock.innerHTML = 'new Block';
  root.append(newBlock);
};
```

</TabItem>
<TabItem value="index.css" label="index.css">

```css
p {
  width: 100px;
}
p:nth-child(6) {
  background: red;
}
```

</TabItem>
</Tabs>

This example is to click the button to add a p element, and the 6th p element is displayed as a red background

![](https://raw.githubusercontent.com/3Alan/images/master/img/hrmtest.gif)

At this time, I think red is not good-looking and want to change it to yellow. Modify and save it in one go.

![image-20200518122346853](https://raw.githubusercontent.com/3Alan/images/master/img/image-20200518122346853.png)

As a result, webpack-dev-server re-rendered all of them for me. I have to click 6 more times to see the effect. What if there are 1000 (although it is unlikely)? Don't I have to click 1000 times üò±.

At this time, configuring HRM can easily solve this problem.

Just configure in webpack.config.js

```js
devServer: {
  contentBase: './dist', // Tell the server where to serve content from
  open: true, // Automatically open the browser
  port: 3001, // Server port number
  hot: true, // Enable HRM
},
```

![](https://raw.githubusercontent.com/3Alan/images/master/img/blockTest.gif)

Done üòé, but here, since css-loader helps us do some update tasks, we didn't write too much code. So what if there is no css-loader to handle it? Let's take a look at the specific configuration.

<Tabs>
<TabItem value="index.js" label="index.js">

```js
import Counter from './counter';
import Number from './number';

Counter();
Number();
```

</TabItem>
<TabItem value="counter.js" label="counter.js">

```js
function Counter() {
  var root = document.getElementById('root');
  var counter = document.createElement('div');
  counter.innerHTML = 0;
  counter.onclick = function () {
    counter.innerHTML = parseInt(counter.innerHTML, 10) + 1;
  };
  root.append(counter);
}

export default Counter;
```

</TabItem>
<TabItem value="number.js" label="number.js">

```js
function Number() {
  var root = document.getElementById('root');
  var data = document.createElement('div');
  data.setAttribute('id', 'number');
  data.innerHTML = '2000';
  root.append(data);
}

export default Number;
```

</TabItem>
</Tabs>

![](https://raw.githubusercontent.com/3Alan/images/master/img/test3.gif)

You can see that when I change number, the status in counter is re-rendered to 0 again üò©.

Here we need to process it through part of the code (css-loader helps us complete this work)

```js
import Counter from './counter';
import Number from './number';

Counter();
Number();

if (module.hot) {
  // If HMR is enabled
  module.hot.accept('./number.js', () => {
    var root = document.getElementById('root');
    root.removeChild(document.getElementById('number'));
    console.log('number is updated');
    Number();
    // Once the number.js file is changed, a series of processing is performed
  });
}
```

![](https://raw.githubusercontent.com/3Alan/images/master/img/test4.gif)

:::info
[HMR Detailed Documentation](https://webpack.js.org/guides/hot-module-replacement/)
:::
