---
slug: performance-optimization
title: webpack Performance Optimization
sidebar_label: Performance Optimization
tags:
  - webpack4.0
categories:
  - Front-end
  - webpack4.0 Learning Summary
references:
  - name: >-
      From Basics to Practice, Hand in Hand to Master the New Version of
      Webpack4.0
    url: 'https://coding.imooc.com/class/chapter/316.html#Anchor'
  - name: webpack Official Website
    url: 'https://webpack.js.org/'
date: 2020-06-03T15:58:33.000Z
keywords:
  - webpack Learning Summary
  - webpack Performance Optimization
description: webpack Learning Summary
sidebar_position: 6
summary: >-
  1. This article introduces how to use TS, Eslint, and webpack to optimize
  project performance.

  2. When using TS, you need to install ts-loader and configure the
  tsconfig.json file.

  3. Eslint is used to unify the code style. You can use eslint-loader to
  perform code checking during packaging.

  4. webpack can support single-page applications by configuring
  devServer.historyApiFallback.

  5. webpack performance optimization includes reducing the use of unnecessary
  Loaders and Plugins, reasonably using Resolve's extensions, mainFiles and
  alias, and using tools such as DllPlugin, multi-process packaging, and
  sourceMap.
ai_translation: true
---

TS, Eslint, webpack Performance Optimization

<!--truncate-->

## Basic Content

### Packaging TS Files

Use ts-loader

```
npm i ts-loader typescript -D
```

The project directory is as follows:

```
ts-test
 â”œâ”€â”€ dist
 â”‚   â””â”€â”€ main.js
 â”œâ”€â”€ package.json
 â”œâ”€â”€ src
 â”‚   â””â”€â”€ index.tsx
 â”œâ”€â”€ tsconfig.json
 â””â”€â”€ webpack.config.js
```

`tsconfig.json` is the configuration file for TS. For more configurations, [click here](https://www.typescriptlang.org/docs/handbook/tsconfig-json.html)

index.tsx

```tsx
interface person {
  name: string;
  ts?: boolean;
}
function Recruit(personObj: person): string {
  if (personObj.ts) {
    return `congratulations!${personObj.name}`;
  } else {
    return `sorry,${personObj.name}, we need a employee who know ts!`;
  }
}
let person1 = { name: 'Alan', age: 21, ts: true };
console.log(Recruit(person1));
let person2 = { name: 'Bob', age: 21 };
console.log(Recruit(person2));
```

tsconfig.json

```json
{
  "compilerOptions": {
    "outDir": "./dist/", // Since it is configured in webpack, it can be configured or not
    "module": "es6",
    "target": "es5",
    "allowJs": true
  }
}
```

webpack.config.js

```js
const path = require('path');

module.exports = {
  mode: 'production',
  entry: './src/index.tsx',
  module: {
    rules: [
      {
        test: /\.tsx?$/,
        exclude: /node_modules/,
        use: 'ts-loader'
      }
    ]
  },
  output: {
    filename: '[name].js',
    path: path.resolve(__dirname, 'dist')
  }
};
```

**When our project installs a third-party library and wants to use it in a ts file, we need to install the `definitions` of the third-party library. The specific library can be found in [TypeSearch](https://microsoft.github.io/TypeSearch/)**

### devServer.historyApiFallback

Single-page applications need to be configured with `devServer.historyApiFallbackï¼š true` in the development environment

### Eslint

Eslint is used to unify the code style. When working in a team, it can ensure that the code style written by everyone is unified, which is conducive to code maintenance.

Usage:

```
npm i eslint -D
```

Initialize configuration

```
npx eslint --init
```

![image-20200603151418086](https://raw.githubusercontent.com/3Alan/images/master/img/image-20200603151418086.png)

After initializing the configuration, we can use it. Here I installed the airbnb standard.

![image-20200603151832567](https://raw.githubusercontent.com/3Alan/images/master/img/image-20200603151832567.png)

The image above shows that eslint prompts that jsx syntax cannot be used in js files, this....ðŸ˜°. What should I do if I want to use it? You can configure rules in the generated `.eslintrc.js` file to ignore this standard.

```js
rules: {
	'react/jsx-filename-extension': 0,
},
```

Since it is difficult to ensure that everyone's development environment is the same in team collaboration, we can combine eslint and webpack, and use a loader to check the code for eslint every time it is packaged, but this may affect the packaging speed. When using it, you need to make a trade-off between speed and code quality. Here is an introduction to the eslint-loader used

```
npm i eslint-loader -D
```

webpack.common.js configuration

```js
rules: [
    {
        test: /\.js$/,
        exclude: /node_modules/, // Do not process js files under node_modules
        use: ['babel-loader', 'eslint-loader'],
    },
],
```

Of course, you can also set `devServer.overlay: true` to display errors in real time on the browser, which is convenient for debugging.

![image-20200603153518433](https://raw.githubusercontent.com/3Alan/images/master/img/image-20200603153518433.png)

### Multi-page Application Packaging

Multiple entries need to be set, and multiple .html files are generated after packaging.

```
src
 â”œâ”€â”€ index.html
 â”œâ”€â”€ index.js
 â””â”€â”€ list.js
```

```js
// webpack's entry and plugins configuration
entry: {
    main: './src/index.js', // Entry file for packaging
    list: './src/list.js',
},
plugins: [
    new HtmlWebpackPlugin({
      template: './src/index.html',
      filename: 'index.html',
      chunks: ['main'],
    }),
    new HtmlWebpackPlugin({
      template: './src/index.html',
      filename: 'list.html',
      chunks: ['list'],
    }),
    new CleanWebpackPlugin(),
],
```

The directory generated after packaging

```
dist
 â”œâ”€â”€ index.html
 â”œâ”€â”€ list.8c4e5ed5eb6302c4c5ef.js
 â”œâ”€â”€ list.8c4e5ed5eb6302c4c5ef.js.map
 â”œâ”€â”€ list.html
 â”œâ”€â”€ main.acc2939e4489e5d76660.js
 â”œâ”€â”€ main.acc2939e4489e5d76660.js.map
 â”œâ”€â”€ vendors~list~main.2d42972bf2bf50e6d3cd.js
 â””â”€â”€ vendors~list~main.2d42972bf2bf50e6d3cd.js.map
```

**Now it's okay to have only two pages, but when there are more pages, we have to configure multiple HtmlWebpackPlugin. So how can we make it configure automatically? Here is a function to handle it**

```js
const generateHtmlPlugin = entry => {
  const plugins = [
    new CleanWebpackPlugin(),
    new webpack.ProvidePlugin({
      _: 'lodash'
    })
  ];

  Object.keys(entry).forEach(item => {
    plugins.push(
      new HtmlWebpackPlugin({
        template: './src/index.html',
        filename: `${item}.html`,
        chunks: [item]
      })
    );
  });
  return plugins;
};
```

Complete webpack configuration (webpack.common.js)

```js
const path = require('path');
const HtmlWebpackPlugin = require('html-webpack-plugin');
const { CleanWebpackPlugin } = require('clean-webpack-plugin');
const webpack = require('webpack');

const generateHtmlPlugin = entry => {
  const plugins = [
    new CleanWebpackPlugin(),
    new webpack.ProvidePlugin
